<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ˆæ¡ˆç®¡ç†å…¨åŠŸèƒ½è¤‡ç¿’ç³»çµ± V5.0 (å°ˆå®¶ç‰ˆ)</title>
    <style>
        :root {
            --primary: #2563eb;
            --primary-light: #eff6ff;
            --secondary: #1e40af;
            --accent: #f59e0b;
            --bg-main: #f8fafc;
            --bg-sidebar: #ffffff;
            --text-main: #334155;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --mask-bg: #cbd5e1;
            --sidebar-width: 280px;
            --success: #10b981;
            --term-highlight: #8b5cf6; /* åè©è§£é‡‹çš„å¼·èª¿è‰² */
        }
        body.dark-mode {
            --primary: #60a5fa;
            --primary-light: #1e293b;
            --secondary: #93c5fd;
            --accent: #fbbf24;
            --bg-main: #0f172a;
            --bg-sidebar: #1e293b;
            --text-main: #e2e8f0;
            --text-muted: #94a3b8;
            --border: #334155;
            --mask-bg: #475569;
            --term-highlight: #a78bfa;
        }
        * { box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Segoe UI', "Microsoft JhengHei", sans-serif;
            line-height: 1.8;
            color: var(--text-main);
            background-color: var(--bg-main);
            margin: 0;
            display: flex;
            height: 100vh;
            overflow: hidden; /* é˜²æ­¢é›™é‡æ²è»¸ */
        }

        /* --- Feature: Reading Progress Bar --- */
        #progress-bar {
            position: fixed; top: 0; left: 0; height: 4px; background: var(--accent);
            width: 0%; z-index: 1002; transition: width 0.1s;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width); background: var(--bg-sidebar);
            border-right: 1px solid var(--border); display: flex; flex-direction: column;
            height: 100vh; position: fixed; z-index: 100; transition: transform 0.3s ease-in-out;
        }
        .sidebar-header { padding: 20px; border-bottom: 1px solid var(--border); }
        .sidebar-header h3 { margin: 0; color: var(--primary); font-size: 1.3em; }
        .shortcuts-hint { font-size: 0.75em; color: var(--text-muted); margin-top: 5px; }
        .search-box { margin-top: 15px; position: relative; }
        .search-box input {
            width: 100%; padding: 10px 35px 10px 12px; border: 2px solid var(--border);
            border-radius: 8px; background: var(--bg-main); color: var(--text-main); outline: none;
        }
        .search-box::after { content: 'ğŸ”'; position: absolute; right: 12px; top: 50%; transform: translateY(-50%); opacity: 0.5; }
        .sidebar-nav { flex: 1; overflow-y: auto; padding: 15px; }
        .nav-link {
            display: flex; align-items: center; padding: 10px 12px; color: var(--text-main);
            text-decoration: none; border-radius: 8px; margin-bottom: 5px; font-size: 0.95em; transition: all 0.2s;
        }
        .nav-link:hover, .nav-link.active { background-color: var(--primary-light); color: var(--primary); font-weight: 600; }
        .progress-dot {
            width: 8px; height: 8px; border-radius: 50%; background: var(--border);
            margin-right: 10px; flex-shrink: 0; transition: background 0.3s;
        }
        .nav-link.mastered .progress-dot { background: var(--success); }
        .sidebar-footer { padding: 15px; border-top: 1px solid var(--border); display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .tool-btn {
            padding: 10px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;
            transition: 0.2s; font-size: 0.9em; display: flex; align-items: center; justify-content: center; gap: 6px;
        }
        #btn-dark { background: var(--text-main); color: var(--bg-main); }
        #btn-reset { background: #ef444433; color: #ef4444; }
        #btn-reset:hover { background: #ef4444; color: white; }
        #btn-flashcard { background: var(--accent); color: #fff; grid-column: span 2; }

        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width); flex: 1; padding: 40px 60px;
            overflow-y: auto; scroll-behavior: smooth; height: 100vh;
        }
        h1 { color: var(--primary); text-align: center; margin-bottom: 10px; }
        .subtitle { text-align: center; color: var(--text-muted); margin-bottom: 50px; }
        h2 {
            background: linear-gradient(135deg, var(--secondary), var(--primary)); color: white;
            padding: 15px 25px; border-radius: 12px; margin: 60px 0 30px 0;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.2);
        }

        /* Section Blocks */
        .section-block {
            background: var(--bg-sidebar); padding: 30px; border-radius: 16px;
            box-shadow: 0 10px 30px -10px rgba(0,0,0,0.05); border: 1px solid var(--border);
            margin-bottom: 35px; transition: all 0.3s;
        }
        .section-block.mastered { opacity: 0.6; filter: grayscale(0.8); }
        .section-header {
            display: flex; align-items: center; justify-content: space-between;
            margin-bottom: 25px; padding-bottom: 15px; border-bottom: 2px solid var(--primary-light);
        }
        .section-header h3 {
            margin: 0; color: var(--secondary); font-size: 1.4em;
            display: flex; align-items: center; gap: 10px;
        }
        .section-header h3::before { content: ''; display: block; width: 6px; height: 24px; background: var(--accent); border-radius: 3px; }
        .master-check {
            cursor: pointer; display: flex; align-items: center; gap: 8px; color: var(--text-muted);
            padding: 6px 12px; border-radius: 20px; border: 2px solid var(--border); font-weight: 600;
            font-size: 0.9em; transition: all 0.2s;
        }
        .master-check:hover { background: var(--primary-light); color: var(--primary); border-color: var(--primary); }
        .master-check.checked { background: var(--success); color: white; border-color: var(--success); }

        /* --- New Feature: Glossary Terms --- */
        .term {
            color: var(--term-highlight);
            font-weight: 600;
            border-bottom: 2px dashed var(--term-highlight);
            cursor: help;
            position: relative;
            transition: all 0.2s;
        }
        .term:hover {
            background-color: var(--term-highlight);
            color: white;
            border-bottom-style: solid;
        }
        /* Icon to indicate clickability */
        .term::after {
            content: '?';
            font-size: 0.7em;
            vertical-align: super;
            margin-left: 2px;
            opacity: 0.7;
        }

        /* Quiz Masks */
        .quiz-mask {
            border-bottom: 2px dotted var(--text-muted); cursor: default; transition: all 0.3s; padding: 0 3px;
        }
        body.quiz-mode .quiz-mask {
            background-color: var(--mask-bg) !important; color: transparent !important;
            border-radius: 4px; user-select: none; border-bottom: none; cursor: pointer;
        }
        body.quiz-mode .quiz-mask.revealed {
            background-color: transparent !important; color: inherit !important;
            border-bottom: 2px solid var(--success); animation: pop 0.3s ease-out;
        }
        @keyframes pop { 50% { transform: scale(1.15); } }

        /* Components */
        .highlight-box {
            background: var(--primary-light); border-left: 5px solid var(--primary);
            padding: 20px; border-radius: 0 12px 12px 0; margin: 25px 0;
        }
        .exam-tip {
            background: #fffbeb; border: 2px solid var(--accent); color: #92400e;
            padding: 15px 20px; border-radius: 12px; margin: 25px 0; display: flex; align-items: flex-start; gap: 15px;
        }
        .exam-tip::before { content: 'ğŸ’¡'; font-size: 1.5em; line-height: 1; }
        body.dark-mode .exam-tip { background: #451a03; color: #fcd34d; }

        table { width: 100%; border-collapse: separate; border-spacing: 0; margin: 25px 0; border-radius: 12px; overflow: hidden; border: 1px solid var(--border); }
        th, td { padding: 15px; border-bottom: 1px solid var(--border); border-right: 1px solid var(--border); vertical-align: top; }
        th { background: var(--primary-light); color: var(--secondary); font-weight: 700; }
        tr:last-child td { border-bottom: none; } th:last-child, td:last-child { border-right: none; }

        /* Floating Buttons */
        .fab-container {
            position: fixed; bottom: 30px; right: 30px; display: flex; flex-direction: column; gap: 15px; z-index: 90;
        }
        .fab {
            width: 56px; height: 56px; border-radius: 28px; border: none; color: white;
            font-size: 1.5em; display: flex; align-items: center; justify-content: center;
            cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.15); transition: all 0.3s;
            opacity: 0.9;
        }
        .fab:hover { transform: scale(1.1); opacity: 1; }
        #quiz-fab { background: var(--primary); }
        body.quiz-mode #quiz-fab { background: var(--accent); animation: pulse 2s infinite; }
        #top-fab { background: var(--text-muted); opacity: 0; pointer-events: none; transform: translateY(20px); }
        #top-fab.visible { opacity: 0.8; pointer-events: auto; transform: translateY(0); }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); } 70% { box-shadow: 0 0 0 15px rgba(245, 158, 11, 0); } 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0); } }

        /* Modals */
        .modal-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.6);
            z-index: 1000; display: none; justify-content: center; align-items: center;
            backdrop-filter: blur(4px); opacity: 0; transition: opacity 0.3s;
        }
        .modal-overlay.active { display: flex; opacity: 1; }
        .modal-content {
            background: var(--bg-sidebar); padding: 30px; border-radius: 20px; width: 90%; max-width: 500px;
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); position: relative; transform: translateY(20px); transition: transform 0.3s;
        }
        .modal-overlay.active .modal-content { transform: translateY(0); }
        .close-modal {
            position: absolute; top: 15px; right: 15px; border: none; background: transparent;
            font-size: 1.5em; color: var(--text-muted); cursor: pointer;
        }

        /* Glossary Modal Specific */
        #glossary-modal .modal-header {
            display: flex; align-items: center; gap: 15px; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid var(--term-highlight);
        }
        #glossary-modal h3 { margin: 0; color: var(--term-highlight); font-size: 1.5em; }
        #glossary-icon { font-size: 2em; }
        .glossary-section { margin-bottom: 15px; }
        .glossary-label { font-weight: bold; color: var(--text-muted); font-size: 0.9em; text-transform: uppercase; margin-bottom: 5px; }
        .glossary-text { font-size: 1.1em; line-height: 1.6; }

        @media (max-width: 768px) {
            .sidebar { transform: translateX(-105%); }
            .sidebar.open { transform: translateX(0); box-shadow: 100px 0 0 rgba(0,0,0,0.5); }
            .main-content { margin-left: 0; padding: 20px 15px 100px 15px; }
            #menu-toggle { display: block !important; position: fixed; top: 15px; left: 15px; z-index: 101; background: var(--bg-sidebar); padding: 10px; border-radius: 8px; border: 1px solid var(--border); box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        }
    </style>
</head>
<body>

    <div id="progress-bar"></div>
    <button id="menu-toggle" style="display:none;">â˜°</button>

    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h3>ğŸš€ å‚™è€ƒç³»çµ± V5.0</h3>
            <div class="shortcuts-hint">å¿«é€Ÿéµ: [Q]èƒŒèª¦ [D]æ·±è‰² [F]æŠ½é¡Œ</div>
            <div class="search-box">
                <input type="text" id="search-input" placeholder="æœå°‹ç­†è¨˜...">
            </div>
        </div>
        <div class="sidebar-nav">
            <a href="#sec1" class="nav-link">ğŸ¯ åŸºç¤æ¦‚å¿µèˆ‡æ¶æ§‹</a>
            <a href="#sec1-1" class="nav-link" style="padding-left: 25px;"><span class="progress-dot" data-target="sec1-1"></span>æ ¸å¿ƒå®šç¾©èˆ‡ç’°å¢ƒ</a>
            <a href="#sec1-2" class="nav-link" style="padding-left: 25px;"><span class="progress-dot" data-target="sec1-2"></span>PMBOK æ¡†æ¶</a>
            <a href="#sec2" class="nav-link">ğŸ§­ èµ·å§‹éšæ®µ (Initiating)</a>
            <a href="#sec2-1" class="nav-link" style="padding-left: 25px;"><span class="progress-dot" data-target="sec2-1"></span>å°ˆæ¡ˆé¸æ“‡æ¨¡å‹</a>
            <a href="#sec2-2" class="nav-link" style="padding-left: 25px;"><span class="progress-dot" data-target="sec2-2"></span>å°ˆæ¡ˆç« ç¨‹</a>
            <a href="#sec2-3" class="nav-link" style="padding-left: 25px;"><span class="progress-dot" data-target="sec2-3"></span>åˆ©å®³é—œä¿‚äºº</a>
            <a href="#sec3" class="nav-link">ğŸ§± è¦åŠƒéšæ®µ (Planning)</a>
            <a href="#sec3-1" class="nav-link" style="padding-left: 25px;"><span class="progress-dot" data-target="sec3-1"></span>è¨ˆç•«æ›¸èˆ‡åŸºæº–</a>
            <a href="#sec3-2" class="nav-link" style="padding-left: 25px;"><span class="progress-dot" data-target="sec3-2"></span>ç¯„ç–‡ç®¡ç† (WBS)</a>
            <a href="#sec3-3" class="nav-link" style="padding-left: 25px;"><span class="progress-dot" data-target="sec3-3"></span>è²¬ä»»åˆ†æ´¾ (RACI)</a>
            <a href="#sec3-4" class="nav-link" style="padding-left: 25px;"><span class="progress-dot" data-target="sec3-4"></span>æºé€šèˆ‡åƒèˆ‡</a>
            <a href="#sec4" class="nav-link">âš™ï¸ PM è§’è‰²èˆ‡çµ„ç¹”</a>
        </div>
        <div class="sidebar-footer">
            <button id="btn-dark" class="tool-btn">ğŸŒ™ å¤œé–“æ¨¡å¼ (D)</button>
            <button id="btn-reset" class="tool-btn">ğŸ—‘ï¸ é‡ç½®ç´€éŒ„</button>
            <button id="btn-flashcard" class="tool-btn">ğŸ² éš¨æ©ŸæŠ½é¡Œè€ƒæˆ‘ (F)</button>
        </div>
    </nav>

    <main class="main-content" id="main-scroll">
        <h1>ğŸ“˜ å°ˆæ¡ˆç®¡ç†æ ¸å¿ƒçŸ¥è­˜ç­†è¨˜</h1>
        <p class="subtitle">é»æ“Š<span class="term" data-term="demo">ç´«è‰²åè©</span>æŸ¥çœ‹è©³ç´°è§£é‡‹ | [Q]éµåˆ‡æ›èƒŒèª¦æ¨¡å¼</p>

        <section id="sec1">
            <h2>ğŸ¯ ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºç¤æ¦‚å¿µèˆ‡æ¶æ§‹</h2>
            <div id="sec1-1" class="section-block">
                <div class="section-header"><h3>å£¹ã€æ ¸å¿ƒå®šç¾©èˆ‡ç’°å¢ƒ</h3><div class="master-check" data-id="sec1-1"><span>â˜</span> æˆ‘å·²æŒæ¡</div></div>
                <div class="content-body">
                    <p><strong>å°ˆæ¡ˆ (Project)ï¼š</strong>ç‚ºå‰µé€ <span class="quiz-mask">ç¨ä¸€ç„¡äºŒ</span>çš„ç”¢å“ã€æœå‹™æˆ–æˆæœï¼Œè€Œå¾äº‹çš„<span class="quiz-mask">æš«æ™‚æ€§</span>åŠªåŠ›ã€‚</p>
                    <ul>
                        <li><strong>æš«æ™‚æ€§ï¼š</strong>æœ‰æ˜ç¢ºèµ·è¨–ã€‚</li>
                        <li><strong><span class="term" data-term="progressive_elaboration">é€æ­¥å®Œå–„</span>ï¼š</strong>éš¨è³‡è¨Šæ˜æœ—ï¼Œè¨ˆç•«ç”±ç²—åˆ°ç´°ã€‚</li>
                        <li><strong><span class="term" data-term="vuca">VUCA æ™‚ä»£</span>ï¼š</strong>ç¾ä»£å°ˆæ¡ˆé¢è‡¨çš„é«˜è®Šå‹•ç’°å¢ƒã€‚</li>
                    </ul>
                    <h4>âš”ï¸ å°ˆæ¡ˆ vs. æ—¥å¸¸ç‡Ÿé‹ (Operations)</h4>
                    <table>
                        <tr><th>æ¯”è¼ƒé …ç›®</th><th>å°ˆæ¡ˆ (Project)</th><th>æ—¥å¸¸ç‡Ÿé‹ (Operations)</th></tr>
                        <tr><td>æ€§è³ª</td><td><span class="quiz-mask">ç¨ç‰¹ã€ä¸€æ¬¡æ€§</span></td><td><span class="quiz-mask">é‡è¤‡æ€§ã€æŒçºŒæ€§</span></td></tr>
                        <tr><td>ç›®çš„</td><td>é©…å‹•<span class="quiz-mask">è®Šé©</span></td><td>ç¶­æŒ<span class="quiz-mask">æ­£å¸¸é‹ä½œ</span></td></tr>
                    </table>
                </div>
                <div class="note-area"><button class="note-toggle">ğŸ“ æ·»åŠ ç­†è¨˜</button><textarea class="my-note"></textarea></div>
            </div>

            <div id="sec1-2" class="section-block">
                <div class="section-header"><h3>è²³ã€PMBOK ç¶“å…¸æ¡†æ¶</h3><div class="master-check" data-id="sec1-2"><span>â˜</span> æˆ‘å·²æŒæ¡</div></div>
                <div class="content-body">
                    <p>å°ˆæ¡ˆç®¡ç†è–ç¶“ <span class="term" data-term="pmbok">PMBOK</span> å®šç¾©äº†äº”å¤§æµç¨‹ç¾¤çµ„èˆ‡åå¤§çŸ¥è­˜é ˜åŸŸã€‚</p>
                    <ul>
                        <li><strong>èµ·å§‹ (Initiating)ï¼š</strong><span class="quiz-mask">æŒ‘ã€å¤ ã€æ–‡ã€äºº</span></li>
                        <li><strong>è¦åŠƒ (Planning)ï¼š</strong><span class="quiz-mask">å·¥ã€è³‡ã€æ’ã€éšª</span> (æœ€å¤§ç¾¤çµ„)</li>
                        <li><strong>åŸ·è¡Œ (Executing)ï¼š</strong><span class="quiz-mask">äººã€ç®¡ã€åŠ©</span> (è€—è²»æœ€å¤šè³‡æº)</li>
                        <li><strong>ç›£æ§ (M&C)ï¼š</strong><span class="quiz-mask">å‚¬ã€æ¯”ã€æã€è¶•</span></li>
                        <li><strong>çµæŸ (Closing)ï¼š</strong><span class="quiz-mask">é©—ã€ç´„ã€éŒ¢ã€å ±</span></li>
                    </ul>
                </div>
                <div class="note-area"><button class="note-toggle">ğŸ“ æ·»åŠ ç­†è¨˜</button><textarea class="my-note"></textarea></div>
            </div>
        </section>

        <section id="sec2">
            <h2>ğŸ§­ ç¬¬äºŒéƒ¨åˆ†ï¼šèµ·å§‹éšæ®µ (Initiating)</h2>
            <div id="sec2-1" class="section-block">
                <div class="section-header"><h3>å£¹ã€å°ˆæ¡ˆé¸æ“‡æ¨¡å‹</h3><div class="master-check" data-id="sec2-1"><span>â˜</span> æˆ‘å·²æŒæ¡</div></div>
                <div class="content-body">
                    <h4>è²¡å‹™æŒ‡æ¨™ (å¿…è€ƒ)</h4>
                    <table>
                        <tr><th>æŒ‡æ¨™</th><th>æ ¸å¿ƒæ¦‚å¿µ</th><th>æ±ºç­–æ¨™æº–</th></tr>
                        <tr><td>é‚„æœ¬æœŸ</td><td>å›æ”¶æŠ•è³‡æ™‚é–“ã€‚<span class="quiz-mask">å¿½ç•¥</span>è²¨å¹£æ™‚é–“åƒ¹å€¼ã€‚</td><td>è¶Š<span class="quiz-mask">çŸ­</span>è¶Šå¥½</td></tr>
                        <tr><td><span class="term" data-term="npv">æ·¨ç¾å€¼ (NPV)</span></td><td>æœªä¾†ç¾é‡‘æµæŠ˜ç¾æ¸›æŠ•è³‡ã€‚<span class="quiz-mask">è€ƒé‡</span>æ™‚é–“åƒ¹å€¼ã€‚</td><td>NPV > 0ï¼Œè¶Š<span class="quiz-mask">é«˜</span>è¶Šå¥½</td></tr>
                        <tr><td><span class="term" data-term="irr">å…§éƒ¨å ±é…¬ç‡ (IRR)</span></td><td>ä½¿ NPV = <span class="quiz-mask">0</span> çš„æŠ˜ç¾ç‡ã€‚</td><td>è¶Šé«˜è¶Šå¥½</td></tr>
                    </table>
                </div>
                <div class="note-area"><button class="note-toggle">ğŸ“ æ·»åŠ ç­†è¨˜</button><textarea class="my-note"></textarea></div>
            </div>

            <div id="sec2-2" class="section-block">
                <div class="section-header"><h3>è²³ã€å°ˆæ¡ˆç« ç¨‹</h3><div class="master-check" data-id="sec2-2"><span>â˜</span> æˆ‘å·²æŒæ¡</div></div>
                <div class="content-body">
                    <div class="highlight-box">
                        <strong><span class="term" data-term="charter">å°ˆæ¡ˆç« ç¨‹</span>ï¼š</strong>å°ˆæ¡ˆçš„ã€Œå‡ºç”Ÿè­‰æ˜ã€ï¼Œæ­£å¼<span class="quiz-mask">æˆæ¬Šå°ˆæ¡ˆå­˜åœ¨</span>ï¼Œä¸¦è³¦äºˆ PM å‹•ç”¨è³‡æºçš„æ¬ŠåŠ›ã€‚
                    </div>
                    <ul>
                        <li>ç”± <span class="term" data-term="sponsor">ç™¼èµ·äºº (Sponsor)</span> ç™¼å¸ƒã€‚</li>
                        <li>ç›®æ¨™éœ€ç¬¦åˆ <span class="term" data-term="smart">SMART åŸå‰‡</span>ã€‚</li>
                    </ul>
                </div>
                <div class="note-area"><button class="note-toggle">ğŸ“ æ·»åŠ ç­†è¨˜</button><textarea class="my-note"></textarea></div>
            </div>

            <div id="sec2-3" class="section-block">
                <div class="section-header"><h3>åƒã€åˆ©å®³é—œä¿‚äººç®¡ç†</h3><div class="master-check" data-id="sec2-3"><span>â˜</span> æˆ‘å·²æŒæ¡</div></div>
                <div class="content-body">
                    <p><span class="term" data-term="stakeholder">åˆ©å®³é—œä¿‚äºº</span>çš„å½±éŸ¿åŠ›åœ¨å°ˆæ¡ˆ<span class="quiz-mask">åˆæœŸ</span>æœ€å¤§ï¼Œè®Šæ›´æˆæœ¬æœ€ä½ã€‚</p>
                    <h4>æ¬ŠåŠ›/å½±éŸ¿åŠ›æ–¹æ ¼åœ–ï¼š</h4>
                    <ul>
                        <li>é«˜æ¬ŠåŠ›ã€é«˜å½±éŸ¿åŠ›ï¼š<strong><span class="quiz-mask">é‡é»ç®¡ç†</span></strong> (VVIP)ã€‚</li>
                        <li>é«˜æ¬ŠåŠ›ã€ä½å½±éŸ¿åŠ›ï¼š<strong><span class="quiz-mask">ä¿æŒæ»¿æ„</span></strong>ã€‚</li>
                        <li>ä½æ¬ŠåŠ›ã€é«˜å½±éŸ¿åŠ›ï¼š<strong><span class="quiz-mask">ä¿æŒå‘ŠçŸ¥</span></strong>ã€‚</li>
                        <li>ä½æ¬ŠåŠ›ã€ä½å½±éŸ¿åŠ›ï¼š<strong><span class="quiz-mask">ç›£ç£</span></strong>ã€‚</li>
                    </ul>
                </div>
                <div class="note-area"><button class="note-toggle">ğŸ“ æ·»åŠ ç­†è¨˜</button><textarea class="my-note"></textarea></div>
            </div>
        </section>

        <section id="sec3">
            <h2>ğŸ§± ç¬¬ä¸‰éƒ¨åˆ†ï¼šè¦åŠƒéšæ®µ (Planning)</h2>
            <div id="sec3-1" class="section-block">
                <div class="section-header"><h3>å£¹ã€è¨ˆç•«æ›¸èˆ‡åŸºæº–</h3><div class="master-check" data-id="sec3-1"><span>â˜</span> æˆ‘å·²æŒæ¡</div></div>
                <div class="content-body">
                    <p><span class="term" data-term="baseline">åŸºæº– (Baseline)</span>æ˜¯ç¶“æ ¸å‡†çš„è¨ˆç•«ç‰ˆæœ¬ã€‚ä¸‰å¤§åŸºæº–ï¼š<span class="quiz-mask">ç¯„ç–‡</span>ã€<span class="quiz-mask">æ™‚ç¨‹</span>ã€<span class="quiz-mask">æˆæœ¬</span>ã€‚</p>
                    <div class="exam-tip">åŸºæº–ä¸€æ—¦ç¢ºç«‹ï¼Œä»»ä½•ä¿®æ”¹éƒ½å¿…é ˆèµ°æ­£å¼çš„<strong><span class="quiz-mask">è®Šæ›´ç®¡åˆ¶æµç¨‹ (CCB)</span></strong>ã€‚</div>
                </div>
                <div class="note-area"><button class="note-toggle">ğŸ“ æ·»åŠ ç­†è¨˜</button><textarea class="my-note"></textarea></div>
            </div>

            <div id="sec3-2" class="section-block">
                <div class="section-header"><h3>è²³ã€ç¯„ç–‡ç®¡ç† (WBS)</h3><div class="master-check" data-id="sec3-2"><span>â˜</span> æˆ‘å·²æŒæ¡</div></div>
                <div class="content-body">
                    <ul>
                        <li><span class="term" data-term="scope_creep">ç¯„ç–‡æ½›è®Š</span>ï¼šæœªç¶“æ ¸å‡†çš„æ“´å¼µ (å£çš„)ã€‚</li>
                        <li><span class="term" data-term="gold_plating">ç¯„ç–‡éé‡‘</span>ï¼šPM ä¸»å‹•å¢åŠ éå¿…è¦åŠŸèƒ½ (å£çš„)ã€‚</li>
                    </ul>
                    <h4><span class="term" data-term="wbs">å·¥ä½œåˆ†è§£çµæ§‹ (WBS)</span></h4>
                    <p>å°‡äº¤ä»˜æˆæœåˆ†è§£ç‚ºå±¤ç´šçµæ§‹ã€‚æœ€åº•å±¤ç‚º<strong><span class="quiz-mask">å·¥ä½œåŒ… (WP)</span></strong>ã€‚</p>
                    <div class="highlight-box">
                        <strong>100% åŸå‰‡ï¼š</strong>WBS å¿…é ˆåŒ…å«å°ˆæ¡ˆ<span class="quiz-mask">æ‰€æœ‰</span>å·¥ä½œï¼Œä¸å¤šä¹Ÿä¸å°‘ã€‚
                    </div>
                </div>
                <div class="note-area"><button class="note-toggle">ğŸ“ æ·»åŠ ç­†è¨˜</button><textarea class="my-note"></textarea></div>
            </div>

            <div id="sec3-3" class="section-block">
                <div class="section-header"><h3>åƒã€è²¬ä»»åˆ†æ´¾ (RACI)</h3><div class="master-check" data-id="sec3-3"><span>â˜</span> æˆ‘å·²æŒæ¡</div></div>
                <div class="content-body">
                    <p>ä½¿ç”¨ <span class="term" data-term="raci">RACI çŸ©é™£</span>é‡æ¸…è·è²¬ï¼š</p>
                    <ul>
                        <li><strong>R (Responsible)ï¼š</strong>åŸ·è¡Œè€…ã€‚</li>
                        <li><strong>A (Accountable)ï¼š</strong>ç•¶è²¬è€… (<span class="quiz-mask" style="color:red;">åªèƒ½ä¸€äºº</span>)ã€‚</li>
                        <li><strong>C (Consult)ï¼š</strong>è«®è©¢è€… (é›™å‘)ã€‚</li>
                        <li><strong>I (Inform)ï¼š</strong>å‘ŠçŸ¥è€… (å–®å‘)ã€‚</li>
                    </ul>
                </div>
                <div class="note-area"><button class="note-toggle">ğŸ“ æ·»åŠ ç­†è¨˜</button><textarea class="my-note"></textarea></div>
            </div>
        </section>

        <section id="sec4">
            <h2>âš™ï¸ ç¬¬å››éƒ¨åˆ†ï¼šPM è§’è‰²èˆ‡çµ„ç¹”</h2>
            <div id="sec4-1" class="section-block">
                <div class="section-header"><h3>å£¹ã€çµ„ç¹”çµæ§‹å° PM çš„å½±éŸ¿</h3><div class="master-check" data-id="sec4-1"><span>â˜</span> æˆ‘å·²æŒæ¡</div></div>
                <div class="content-body">
                    <table>
                        <tr><th>çµ„ç¹”å‹æ…‹</th><th>PM æ¬Šé™</th><th>PM è§’è‰²</th></tr>
                        <tr><td>åŠŸèƒ½å‹</td><td><span class="quiz-mask">æ¥µä½</span></td><td>å…¼è·</td></tr>
                        <tr><td>å¼±çŸ©é™£</td><td>ä½</td><td>å…¼è·</td></tr>
                        <tr><td>å¹³è¡¡çŸ©é™£</td><td>ä¸­</td><td><span class="quiz-mask">å…¨è·</span> (é›™è€é—†)</td></tr>
                        <tr><td>å¼·çŸ©é™£</td><td>é«˜</td><td>å…¨è·</td></tr>
                        <tr><td>å°ˆæ¡ˆå‹</td><td><span class="quiz-mask">æ¥µé«˜</span></td><td>å…¨è·</td></tr>
                    </table>
                </div>
                <div class="note-area"><button class="note-toggle">ğŸ“ æ·»åŠ ç­†è¨˜</button><textarea class="my-note"></textarea></div>
            </div>
        </section>
    </main>

    <div class="fab-container">
        <button id="top-fab" class="fab" title="å›åˆ°é ‚ç«¯">â¬†</button>
        <button id="quiz-fab" class="fab" title="åˆ‡æ›èƒŒèª¦æ¨¡å¼ (Q)">ğŸ›¡ï¸</button>
    </div>

    <div class="modal-overlay" id="glossary-modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeGlossary()">Ã—</button>
            <div class="modal-header">
                <span id="glossary-icon">ğŸ“–</span>
                <h3 id="glossary-title">åè©æ¨™é¡Œ</h3>
            </div>
            <div class="glossary-section">
                <div class="glossary-label">å®šç¾©</div>
                <div class="glossary-text" id="glossary-def">...</div>
            </div>
            <div class="glossary-section" style="margin-top: 25px;">
                <div class="glossary-label" style="color: var(--accent);">å¯¦å‹™æ‡‰ç”¨ / è€ƒè©¦é‡é»</div>
                <div class="glossary-text" id="glossary-app">...</div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="flashcard-modal">
        <div class="modal-content" style="text-align: center;">
            <button class="close-modal" onclick="closeFlashcard()">Ã—</button>
            <h3 style="color: var(--primary);">ğŸ² éš¨æ©ŸæŠ½è€ƒ</h3>
            <p style="color: var(--text-muted); font-size: 0.9em;" id="flash-context"></p>
            <div id="flash-q" style="font-size: 1.3em; margin: 30px 0; min-height: 60px;"></div>
            <div id="flash-a" style="font-size: 1.5em; color: var(--success); font-weight: bold; padding: 20px; background: var(--primary-light); border-radius: 12px; display: none;"></div>
            <button id="flash-reveal" class="tool-btn" style="width:100%; background:var(--primary); color:#fff; padding:15px; margin-top:20px; font-size:1.1em;">çœ‹ç­”æ¡ˆ</button>
            <button id="flash-next" class="tool-btn" style="width:100%; background:var(--accent); color:#fff; padding:15px; margin-top:10px; display:none; font-size:1.1em;">ä¸‹ä¸€é¡Œ â†’</button>
        </div>
    </div>

    <script>
        // === 1. GLOSSARY DATABASE (åè©è§£é‡‹è³‡æ–™åº«) ===
        const glossaryDB = {
            "demo": {
                title: "åŠŸèƒ½ç¤ºç¯„",
                def: "é€™æ˜¯ä¸€å€‹åè©è§£é‡‹è¦–çª—ã€‚é»æ“Šæ–‡ä¸­å¸¶æœ‰è™›ç·šåº•ç·šçš„ç´«è‰²åè©ï¼Œå°±æœƒå½ˆå‡ºé€™å€‹è¦–çª—ã€‚",
                app: "å¹«åŠ©æ‚¨åœ¨é–±è®€æ™‚ï¼Œéš¨æ™‚æŸ¥é–±ä¸ç†Ÿæ‚‰çš„å°ˆæœ‰åè©ï¼Œè€Œä¸ç”¨ä¸­æ–·å­¸ç¿’æµç¨‹ã€‚"
            },
            "progressive_elaboration": {
                title: "é€æ­¥å®Œå–„ (Progressive Elaboration)",
                def: "éš¨è‘—å°ˆæ¡ˆé€²å±•ï¼Œè³‡è¨Šè¶Šä¾†è¶Šæ˜æœ—ï¼Œè¨ˆç•«ä¹Ÿå¾ç²—ç•¥é€æ¼¸è®Šå¾—è©³ç´°çš„éç¨‹ã€‚",
                app: "é©ç”¨æ–¼ã€Œæ»¾å‹•å¼è¦åŠƒ (Rolling Wave Planning)ã€ï¼Œè¿‘æœŸå·¥ä½œè©³ç´°è¦åŠƒï¼Œé æœŸå·¥ä½œåƒ…è¦åŠƒå¤§æ–¹å‘ã€‚"
            },
            "vuca": {
                title: "VUCA æ™‚ä»£",
                def: "æè¿°ç¾ä»£ç’°å¢ƒçš„å››å€‹ç‰¹æ€§ï¼šæ˜“è®Šæ€§ (Volatility)ã€ä¸ç¢ºå®šæ€§ (Uncertainty)ã€è¤‡é›œæ€§ (Complexity)ã€æ¨¡ç³Šæ€§ (Ambiguity)ã€‚",
                app: "åœ¨ VUCA ç’°å¢ƒä¸‹ï¼Œå‚³çµ±é æ¸¬å‹(ç€‘å¸ƒ)ç®¡ç†å¯èƒ½å¤±æ•ˆï¼Œéœ€å¼•å…¥æ•æ·(Agile)æ€ç¶­ä¾†å¿«é€Ÿæ‡‰å°è®ŠåŒ–ã€‚"
            },
            "pmbok": {
                title: "å°ˆæ¡ˆç®¡ç†çŸ¥è­˜é«”ç³» (PMBOK)",
                def: "ç”± PMI ç™¼å¸ƒçš„å°ˆæ¡ˆç®¡ç†æ¨™æº–æŒ‡å—ï¼Œå®šç¾©äº† 5 å¤§æµç¨‹ç¾¤çµ„èˆ‡ 10 å¤§çŸ¥è­˜é ˜åŸŸã€‚",
                app: "æ˜¯ PMP è€ƒè©¦çš„æ ¸å¿ƒä¾æ“šï¼Œæä¾›äº†å…¨çƒé€šç”¨çš„å°ˆæ¡ˆç®¡ç†èªè¨€èˆ‡æ¶æ§‹ã€‚"
            },
            "npv": {
                title: "æ·¨ç¾å€¼ (NPV)",
                def: "å°‡æœªä¾†æ‰€æœ‰é æœŸçš„ç¾é‡‘æµå…¥èˆ‡æµå‡ºï¼Œä»¥ç‰¹å®šæŠ˜ç¾ç‡æŠ˜ç®—æˆã€Œä»Šå¤©çš„åƒ¹å€¼ã€å¾Œç›¸åŠ çš„ç¸½å’Œã€‚",
                app: "æœ€é‡è¦çš„è²¡å‹™é¸æ“‡æŒ‡æ¨™ã€‚NPV > 0 ä»£è¡¨å°ˆæ¡ˆè³ºéŒ¢ã€‚å¤šå€‹å°ˆæ¡ˆæ¯”è¼ƒæ™‚ï¼Œé¸æ“‡ NPV æœ€é«˜çš„ã€‚"
            },
            "irr": {
                title: "å…§éƒ¨å ±é…¬ç‡ (IRR)",
                def: "ä½¿å°ˆæ¡ˆæ·¨ç¾å€¼ (NPV) ç­‰æ–¼é›¶æ™‚çš„æŠ˜ç¾ç‡ã€‚ä»£è¡¨å°ˆæ¡ˆæœ¬èº«èƒ½ç”¢ç”Ÿçš„é æœŸæŠ•è³‡å ±é…¬ç‡ã€‚",
                app: "IRR è¶Šé«˜è¶Šå¥½ã€‚é€šå¸¸éœ€å¤§æ–¼å…¬å¸è¨­å®šçš„ã€Œæœ€ä½é–€æª»å ±é…¬ç‡ (Hurdle Rate)ã€æ‰å€¼å¾—æŠ•è³‡ã€‚"
            },
            "charter": {
                title: "å°ˆæ¡ˆç« ç¨‹ (Project Charter)",
                def: "æ­£å¼æˆæ¬Šå°ˆæ¡ˆæˆç«‹çš„æ–‡ä»¶ï¼Œæ˜¯å°ˆæ¡ˆçš„ã€Œå‡ºç”Ÿè­‰æ˜ã€ã€‚",
                app: "ä¸€æ—¦ç°½ç½²ï¼ŒPM å³ç²å¾—å‹•ç”¨çµ„ç¹”è³‡æºçš„æ¬ŠåŠ›ã€‚å…§å®¹åŒ…å«é«˜å±¤ç´šéœ€æ±‚ã€é ç®—ã€é‡Œç¨‹ç¢‘èˆ‡ PM ä»»å‘½ã€‚"
            },
            "sponsor": {
                title: "ç™¼èµ·äºº (Sponsor)",
                def: "æä¾›å°ˆæ¡ˆè³‡é‡‘èˆ‡è³‡æºçš„äººï¼Œé€šå¸¸ä¹Ÿæ˜¯å°ˆæ¡ˆç« ç¨‹çš„ç°½ç½²è€…ã€‚",
                app: "æ˜¯ PM åœ¨çµ„ç¹”å…§çš„é å±±ï¼Œè² è²¬è§£æ±º PM ç„¡æ³•è™•ç†çš„é«˜å±¤ç´šæ”¿æ²»å•é¡Œæˆ–è³‡æºè¡çªã€‚"
            },
            "smart": {
                title: "SMART åŸå‰‡",
                def: "ç›®æ¨™è¨­å®šæ¨™æº–ï¼šSpecific(æ˜ç¢º)ã€Measurable(å¯è¡¡é‡)ã€Attainable(å¯é”æˆ)ã€Relevant(ç›¸é—œ)ã€Time-bound(æœ‰æ™‚é™)ã€‚",
                app: "æ’°å¯«å°ˆæ¡ˆç›®æ¨™æˆ– KPI æ™‚å¿…é ˆç¬¦åˆæ­¤äº”é …ï¼Œé¿å…ç›®æ¨™ç©ºæ³›ç„¡æ³•é©—æ”¶ã€‚"
            },
            "stakeholder": {
                title: "åˆ©å®³é—œä¿‚äºº (Stakeholder)",
                def: "ä»»ä½•æœƒå½±éŸ¿å°ˆæ¡ˆã€è¢«å°ˆæ¡ˆå½±éŸ¿ï¼Œæˆ–è‡ªèªæœƒè¢«å½±éŸ¿çš„å€‹äººæˆ–åœ˜é«”ã€‚",
                app: "PM éœ€ç›¡æ—©è¾¨è­˜ä»–å€‘ï¼Œä¸¦ä¾ã€Œæ¬ŠåŠ›/å½±éŸ¿åŠ›ã€æ±ºå®šç®¡ç†ç­–ç•¥ï¼Œé¿å…ä»–å€‘åœ¨å°ˆæ¡ˆå¾ŒæœŸæå‡ºè®Šæ›´å°è‡´æˆæœ¬æš´å¢ã€‚"
            },
            "baseline": {
                title: "åŸºæº– (Baseline)",
                def: "ç¶“ç”±æ­£å¼ç¨‹åºæ ¸å‡†çš„è¨ˆç•«ç‰ˆæœ¬ï¼ŒåŒ…å«ç¯„ç–‡ã€æ™‚ç¨‹ã€æˆæœ¬ä¸‰å¤§åŸºæº–ã€‚",
                app: "æ˜¯è¡¡é‡å°ˆæ¡ˆç¸¾æ•ˆçš„ã€Œå°ºã€ã€‚å¯¦éš›åŸ·è¡Œçµæœéœ€èˆ‡åŸºæº–æ¯”è¼ƒï¼Œä»¥åˆ¤æ–·å°ˆæ¡ˆæ˜¯å¦åé›¢è»Œé“ã€‚"
            },
            "scope_creep": {
                title: "ç¯„ç–‡æ½›è®Š (Scope Creep)",
                def: "å°ˆæ¡ˆç¯„ç–‡åœ¨æœªç¶“å¯©æŸ¥ä¸‹ï¼Œä¸çŸ¥ä¸è¦ºåœ°æ“´å¼µï¼ˆä¾‹å¦‚å®¢æˆ¶ç§ä¸‹è¦æ±‚å·¥ç¨‹å¸«åŠ åŠŸèƒ½ï¼‰ã€‚",
                app: "æ˜¯å°ˆæ¡ˆå¸¸è¦‹çš„å¤±æ•—åŸå› ã€‚å¿…é ˆé€éåš´æ ¼çš„ã€Œè®Šæ›´ç®¡åˆ¶æµç¨‹ã€ä¾†é é˜²ã€‚"
            },
            "gold_plating": {
                title: "ç¯„ç–‡éé‡‘ (Gold Plating)",
                def: "å°ˆæ¡ˆåœ˜éšŠç‚ºäº†å–æ‚…å®¢æˆ¶ï¼Œä¸»å‹•åšäº†è¶…å‡ºåŸå®šç¯„ç–‡çš„åŠŸèƒ½ã€‚",
                app: "é›–ç„¶ç«‹æ„è‰¯å¥½ï¼Œä½†å¢åŠ äº†é¢¨éšªèˆ‡æˆæœ¬ä¸”å®¢æˆ¶ä¸ä¸€å®šè²·å–®ï¼ŒPMBOK ä¸å»ºè­°æ­¤è¡Œç‚ºã€‚"
            },
            "wbs": {
                title: "å·¥ä½œåˆ†è§£çµæ§‹ (WBS)",
                def: "å°‡å°ˆæ¡ˆå¯äº¤ä»˜æˆæœå’Œå°ˆæ¡ˆå·¥ä½œåˆ†è§£æˆè¼ƒå°çš„ã€æ›´æ˜“æ–¼ç®¡ç†çš„çµ„æˆéƒ¨åˆ†ï¼ˆå·¥ä½œåŒ…ï¼‰çš„å±¤ç´šçµæ§‹ã€‚",
                app: "è¦åŠƒéšæ®µçš„æ ¸å¿ƒå·¥å…·ã€‚ç¢ºä¿å·¥ä½œä¸éºæ¼ï¼ˆ100%åŸå‰‡ï¼‰ï¼Œä¸¦ä½œç‚ºä¼°ç®—æˆæœ¬èˆ‡æ™‚ç¨‹çš„åŸºç¤ã€‚"
            },
            "raci": {
                title: "è²¬ä»»åˆ†æ´¾çŸ©é™£ (RACI)",
                def: "ç”¨ä¾†é‡æ¸…æ¯å€‹å·¥ä½œåŒ…ä¸­è§’è‰²è·è²¬çš„å·¥å…·ï¼šç•¶è²¬è€…(A)ã€è² è²¬è€…(R)ã€è«®è©¢è€…(C)ã€å‘ŠçŸ¥è€…(I)ã€‚",
                app: "é¿å…è²¬ä»»ä¸æ¸…èˆ‡æ¨è«‰ã€‚é—œéµåŸå‰‡ï¼šæ¯å€‹ä»»å‹™åªèƒ½æœ‰ä¸€å€‹ç•¶è²¬è€… (A)ã€‚"
            }
        };

        // === 2. CORE APP LOGIC ===
        const STORAGE_KEY = 'pm_v5_data';
        let appData = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{"progress":{}, "notes":{}, "dark":false}');

        // Init UI
        if (appData.dark) document.body.classList.add('dark-mode');
        Object.keys(appData.progress).forEach(id => updateMasterUI(id, appData.progress[id]));
        document.querySelectorAll('.my-note').forEach(el => {
            const id = el.closest('.section-block').id;
            if(appData.notes[id]) { el.value = appData.notes[id]; el.style.display = 'block'; }
        });

        // Save Data Helper
        function saveData() { localStorage.setItem(STORAGE_KEY, JSON.stringify(appData)); }

        // --- Event Listeners ---
        // Dark Mode
        function toggleDark() {
            appData.dark = !appData.dark;
            document.body.classList.toggle('dark-mode', appData.dark);
            saveData();
        }
        document.getElementById('btn-dark').addEventListener('click', toggleDark);

        // Quiz Mode
        function toggleQuiz() {
            const active = document.body.classList.toggle('quiz-mode');
            const fab = document.getElementById('quiz-fab');
            fab.textContent = active ? 'ğŸ“' : 'ğŸ›¡ï¸';
            fab.title = active ? "é€€å‡ºèƒŒèª¦æ¨¡å¼ (Q)" : "åˆ‡æ›èƒŒèª¦æ¨¡å¼ (Q)";
            if(!active) document.querySelectorAll('.quiz-mask.revealed').forEach(el => el.classList.remove('revealed'));
        }
        document.getElementById('quiz-fab').addEventListener('click', toggleQuiz);
        document.body.addEventListener('click', e => {
            if(document.body.classList.contains('quiz-mode') && e.target.classList.contains('quiz-mask')) {
                e.target.classList.add('revealed');
            }
        });

        // Glossary Click Handler
        document.body.addEventListener('click', e => {
            const termEl = e.target.closest('.term');
            if(termEl) {
                const key = termEl.dataset.term;
                const data = glossaryDB[key];
                if(data) {
                    document.getElementById('glossary-title').textContent = data.title;
                    document.getElementById('glossary-def').textContent = data.def;
                    document.getElementById('glossary-app').textContent = data.app;
                    document.getElementById('glossary-modal').classList.add('active');
                }
            }
        });
        function closeGlossary() { document.getElementById('glossary-modal').classList.remove('active'); }

        // Master Checkbox
        document.querySelectorAll('.master-check').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const id = btn.dataset.id;
                appData.progress[id] = !appData.progress[id];
                updateMasterUI(id, appData.progress[id]);
                saveData();
                e.stopPropagation();
            });
        });
        function updateMasterUI(id, isMastered) {
            const sec = document.getElementById(id);
            if(sec) {
                sec.classList.toggle('mastered', isMastered);
                sec.querySelector('.master-check').innerHTML = isMastered ? '<span>â˜‘</span> å·²æŒæ¡' : '<span>â˜</span> æˆ‘å·²æŒæ¡';
                const dot = document.querySelector(`.progress-dot[data-target="${id}"]`);
                if(dot) dot.parentElement.classList.toggle('mastered', isMastered);
            }
        }

        // Notes
        document.querySelectorAll('.note-toggle').forEach(btn => btn.addEventListener('click', e => {
            const area = e.target.nextElementSibling;
            area.style.display = area.style.display === 'block' ? 'none' : 'block';
        }));
        document.querySelectorAll('.my-note').forEach(el => el.addEventListener('input', e => {
            appData.notes[el.closest('.section-block').id] = e.target.value;
            saveData();
        }));

        // Reading Progress & Scroll to Top
        const mainEl = document.getElementById('main-scroll');
        const progressBar = document.getElementById('progress-bar');
        const topFab = document.getElementById('top-fab');
        mainEl.addEventListener('scroll', () => {
            const scrolled = mainEl.scrollTop;
            const maxScroll = mainEl.scrollHeight - mainEl.clientHeight;
            const percentage = (scrolled / maxScroll) * 100;
            progressBar.style.width = percentage + '%';
            topFab.classList.toggle('visible', scrolled > 300);
        });
        topFab.addEventListener('click', () => mainEl.scrollTo({top: 0, behavior: 'smooth'}));

        // --- Flashcard System (Simplified) ---
        let flashcards = [];
        document.querySelectorAll('.quiz-mask').forEach(mask => {
            if(mask.innerText.trim()) {
                let q = mask.closest('p, li, td').cloneNode(true);
                q.querySelectorAll('.quiz-mask').forEach(m => {
                   if(m.innerText === mask.innerText) { m.innerText = 'ã€_____ã€‘'; m.style.borderBottom = '3px solid var(--accent)'; }
                });
                flashcards.push({q: q.innerHTML, a: mask.innerText, src: mask.closest('.section-block').querySelector('h3').innerText});
            }
        });
        const flashModal = document.getElementById('flashcard-modal');
        function showFlashcard() {
            if(!flashcards.length) return;
            const card = flashcards[Math.floor(Math.random() * flashcards.length)];
            document.getElementById('flash-q').innerHTML = card.q;
            document.getElementById('flash-a').innerText = card.a;
            document.getElementById('flash-context').innerText = `å‡ºè™•ï¼š${card.src}`;
            document.getElementById('flash-a').style.display = 'none';
            document.getElementById('flash-reveal').style.display = 'block';
            document.getElementById('flash-next').style.display = 'none';
            flashModal.classList.add('active');
        }
        function closeFlashcard() { flashModal.classList.remove('active'); }
        document.getElementById('btn-flashcard').addEventListener('click', showFlashcard);
        document.getElementById('flash-reveal').addEventListener('click', function() {
            document.getElementById('flash-a').style.display = 'block';
            this.style.display = 'none';
            document.getElementById('flash-next').style.display = 'block';
        });
        document.getElementById('flash-next').addEventListener('click', showFlashcard);

        // --- Keyboard Shortcuts ---
        document.addEventListener('keydown', e => {
            if(e.target.tagName === 'TEXTAREA' || e.target.tagName === 'INPUT') return; // Don't trigger when typing
            switch(e.key.toLowerCase()) {
                case 'q': toggleQuiz(); break;
                case 'd': toggleDark(); break;
                case 'f': showFlashcard(); break;
                case 'escape': closeGlossary(); closeFlashcard(); break;
            }
        });

        // Reset
        document.getElementById('btn-reset').addEventListener('click', () => {
            if(confirm('ç¢ºå®šæ¸…ç©ºæ‰€æœ‰ç´€éŒ„ï¼Ÿ')) { localStorage.removeItem(STORAGE_KEY); location.reload(); }
        });
        // Mobile Menu
        document.getElementById('menu-toggle').addEventListener('click', () => document.getElementById('sidebar').classList.add('open'));
        document.addEventListener('click', e => {
            if(window.innerWidth <= 768 && !e.target.closest('.sidebar') && !e.target.closest('#menu-toggle')) {
                document.getElementById('sidebar').classList.remove('open');
            }
        });
    </script>
</body>
</html>
